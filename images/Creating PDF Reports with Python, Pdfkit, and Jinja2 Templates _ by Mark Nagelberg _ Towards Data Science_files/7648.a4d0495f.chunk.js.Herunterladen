(self.webpackChunklite=self.webpackChunklite||[]).push([[7648],{14856:(e,n,t)=>{"use strict";t.d(n,{Z:()=>a});var r=t(67294);function s(){return(s=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}var i=r.createElement("rect",{x:26.25,y:9.25,width:.5,height:6.5,rx:.25,strokeWidth:.5}),u=r.createElement("rect",{x:29.75,y:12.25,width:.5,height:6.5,rx:.25,transform:"rotate(90 29.75 12.25)",strokeWidth:.5}),l=r.createElement("path",{d:"M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5",strokeLinecap:"round"}),o=r.createElement("path",{d:"M11.5 14.5L19 20l4-3",strokeLinecap:"round"});const a=function(e){return r.createElement("svg",s({width:38,height:38,viewBox:"0 0 38 38",fill:"none"},e),i,u,l,o)}},99033:(e,n,t)=>{"use strict";t.d(n,{DI:()=>P,nj:()=>_,oT:()=>j});var r=t(59713),s=t.n(r),i=t(63038),u=t.n(i),l=t(28655),o=t.n(l),a=t(82492),c=t.n(a),d=t(71439),b=t(46829),w=t(67294),v=t(53976),f=t(81474),m=t(32589),g=t(95760),p=t(51512),h=t(85277);function S(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function V(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?S(Object(t),!0).forEach((function(n){s()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):S(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function y(){var e=o()(["\n  mutation fetchOrLazilyCreateNewsletterV3AndMaybeSubscribe(\n    $userId: ID!\n    $shouldSubscribeCurrentUser: Boolean\n  ) {\n    fetchOrLazilyCreateNewsletterV3AndMaybeSubscribe(\n      userId: $userId\n      shouldSubscribeCurrentUser: $shouldSubscribeCurrentUser\n    ) {\n      __typename\n      ...useNewsletterV3Subscription_newsletterV3\n    }\n  }\n  ","\n"]);return y=function(){return e},e}function E(){var e=o()(["\n  mutation unsubscribeNewsletterV3($newsletterV3Id: ID!) {\n    unsubscribeNewsletterV3(newsletterV3Id: $newsletterV3Id)\n  }\n"]);return E=function(){return e},e}function N(){var e=o()(["\n  mutation subscribeNewsletterV3($newsletterV3Id: ID!, $shouldRecordConsent: Boolean) {\n    subscribeNewsletterV3(\n      newsletterV3Id: $newsletterV3Id\n      shouldRecordConsent: $shouldRecordConsent\n    )\n  }\n"]);return N=function(){return e},e}function O(){var e=o()(["\n  fragment useNewsletterV3Subscription_newsletterV3_viewerEdge on NewsletterV3 {\n    viewerEdge {\n      id\n      isSubscribed\n    }\n  }\n"]);return O=function(){return e},e}function C(){var e=o()(["\n  fragment useNewsletterV3Subscription_user on User {\n    id\n    username\n    newsletterV3 {\n      ...useNewsletterV3Subscription_newsletterV3\n    }\n  }\n  ","\n"]);return C=function(){return e},e}function I(){var e=o()(["\n  fragment useNewsletterV3Subscription_newsletterV3 on NewsletterV3 {\n    id\n    type\n    slug\n    name\n    collection {\n      slug\n    }\n    user {\n      id\n      name\n      username\n      newsletterV3 {\n        id\n      }\n    }\n  }\n"]);return I=function(){return e},e}var P=(0,d.Ps)(I()),_=(0,d.Ps)(C(),P),k=((0,d.Ps)(O()),(0,d.Ps)(N())),T=(0,d.Ps)(E()),L=(0,d.Ps)(y(),P),j=function(e){var n=e.newsletterV3,t=e.creator,r=e.newsletterName,s=n||{},i=s.id,l=s.type,o=s.slug,a=s.collection,d=(null==n?void 0:n.user)||t,S=null!=r?r:null==n?void 0:n.name,y=w.useState(!1),E=u()(y,2),N=E[0],O=E[1],C=(0,f.T)({newsletterSlug:o,collectionSlug:null==a?void 0:a.slug,username:null==d?void 0:d.username}),I=C.viewerEdge,P=C.loading,j=(0,v.VB)({name:"enable_auto_follow_on_subscribe",placeholder:!1}),x=w.useState(!1),R=u()(x,2),U=R[0],D=R[1];w.useEffect((function(){D(!(null==I||!I.isSubscribed))}),[null==I?void 0:I.isSubscribed]);var $=(0,g.Av)(),M=(0,p.Qi)(),A=(0,h.w)();N&&$.event("newsletterV3.subscribe.error",{newsletterV3Id:i});var B=function(e,n,t){if(t){var r={id:"User:".concat(null==d?void 0:d.id),fragment:_,fragmentName:"useNewsletterV3Subscription_user"},s=e.readFragment(r);e.writeFragment(V(V({},r),{},{data:V(V({},s),{},{newsletterV3:t})}))}if(I){var i=e.readQuery({query:f.p,variables:{newsletterSlug:o,collectionSlug:null==a?void 0:a.slug,username:null==d?void 0:d.username}}),u=c()({},i,{newsletterV3:{viewerEdge:{isSubscribed:n}}});e.writeQuery({query:f.p,variables:{newsletterSlug:o||"",collectionSlug:null==a?void 0:a.slug,username:null==d?void 0:d.username},data:u})}if(n&&j){var l=e.readQuery({query:m.J4,variables:{userId:null==d?void 0:d.id}}),b=c()({},l,{user:{viewerEdge:{isFollowing:!0}}});e.writeQuery({query:m.J4,variables:{userId:(null==d?void 0:d.id)||""},data:b})}},F=(0,b.useMutation)(k,{onCompleted:function(e){var n=e.subscribeNewsletterV3;O(!n),n&&($.event("newsletterV3.subscribeClicked",{newsletterV3Id:i,source:M}),D(!0))},update:function(e){B(e,!0)}}),z=u()(F,1)[0],W=(0,b.useMutation)(T,{onCompleted:function(e){var n=e.unsubscribeNewsletterV3;O(!n),n&&(D(!1),A({duration:"NEXTPAGE",toastStyle:"NEWSLETTER_UNSUBSCRIBE",extraParams:{newsletterName:S||null,newsletterType:l||null,unsubscribeFn:function(){return D(!1)}}}))},update:function(e){B(e,!1)}}),Q=u()(W,1)[0],q=(0,b.useMutation)(L,{onCompleted:function(e){var n=e.fetchOrLazilyCreateNewsletterV3AndMaybeSubscribe;O(!n),n&&($.event("newsletterV3.subscribeClicked",{newsletterV3Id:n.id,source:M}),D(!0))},update:function(e,n){var t,r=V({},null===(t=n.data)||void 0===t?void 0:t.fetchOrLazilyCreateNewsletterV3AndMaybeSubscribe);B(e,!0,r)}}),G=u()(q,1)[0];return{isSubscribed:U,hasError:N,setSubscribe:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];O(!1),e&&!n&&null!=t&&t.id?G({variables:{userId:null==t?void 0:t.id,shouldSubscribeCurrentUser:!0}}):e&&null!=n&&n.id?z({variables:{newsletterV3Id:null==n?void 0:n.id,shouldRecordConsent:r}}):null!=n&&n.id?Q({variables:{newsletterV3Id:null==n?void 0:n.id}}):O(!0)},loading:P}}},81474:(e,n,t)=>{"use strict";t.d(n,{T:()=>o,p:()=>a});var r=t(28655),s=t.n(r),i=t(46829),u=t(71439);function l(){var e=s()(["\n  query NewsletterV3ViewerEdge($newsletterSlug: ID!, $collectionSlug: ID, $username: ID) {\n    newsletterV3(\n      newsletterSlug: $newsletterSlug\n      collectionSlug: $collectionSlug\n      username: $username\n    ) {\n      ... on NewsletterV3 {\n        id\n        viewerEdge {\n          id\n          isSubscribed\n        }\n      }\n    }\n  }\n"]);return l=function(){return e},e}var o=function(e){var n,t=e.newsletterSlug,r=void 0===t?"":t,s=e.collectionSlug,u=e.username,l=(0,i.useQuery)(a,{variables:{newsletterSlug:r,collectionSlug:s,username:u},ssr:!1,skip:!r&&!u}),o=l.loading,c=l.error,d=l.data;return o?{loading:o}:c?{error:c}:{viewerEdge:null==d||null===(n=d.newsletterV3)||void 0===n?void 0:n.viewerEdge}},a=(0,u.Ps)(l())},77648:(e,n,t)=>{"use strict";t.d(n,{X:()=>j,w:()=>x});var r=t(28655),s=t.n(r),i=t(63038),u=t.n(i),l=t(71439),o=t(67294),a=t(99033),c=t(76532),d=t(62181),b=t(55099),w=t(52862),v=t(42933),f=t(92528),m=t(98024),g=t(95760),p=t(51512),h=t(6688),S=t(77180),V=t(14391),y=t(85277),E=t(8403);function N(){return(N=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}var O=o.createElement("path",{d:"M24 13l2 2 3-3.5",strokeLinecap:"round",strokeLinejoin:"round"}),C=o.createElement("path",{d:"M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5",strokeLinecap:"round"}),I=o.createElement("path",{d:"M11.5 14.5L19 20l4-3",strokeLinecap:"round"});const P=function(e){return o.createElement("svg",N({width:38,height:38,viewBox:"0 0 38 38",fill:"none"},e),O,C,I)};var _=t(14856),k=t(51064),T=t(27952);function L(){var e=s()(["\n  fragment UserSubscribeButton_user on User {\n    id\n    name\n    viewerEdge {\n      id\n      isFollowing\n      isUser\n    }\n    viewerIsUser\n    newsletterV3 {\n      id\n      ...useNewsletterV3Subscription_newsletterV3\n    }\n    ...useNewsletterV3Subscription_user\n  }\n  ","\n  ","\n"]);return L=function(){return e},e}var j=function(e){var n=e.user,t=(0,h.I)(),r=(0,S.F)(),s=(0,c.H)().value,i=(0,k.O)(!1),l=u()(i,3),N=l[0],O=l[1],C=l[2],I=n.newsletterV3,L=(0,y.w)(),j=(0,g.Av)(),x=(0,p.Lk)(),R=(0,E.PM)(),U=(0,a.oT)({newsletterV3:I,creator:n,newsletterName:n.name||void 0}),D=U.isSubscribed,$=U.hasError,M=U.loading,A=U.setSubscribe;if(o.useEffect((function(){if(R){var e=(0,p.P7)(R||"").susiEntry;["newsletter_v3_promo","writer_subscription_landing"].includes(void 0===e?"":e)&&D&&L({duration:"NEXTPAGE",toastStyle:"NEWSLETTER_SUBSCRIBE",extraParams:{newsletterName:n.name,newsletterType:V.Rr.NEWSLETTER_TYPE_AUTHOR,unsubscribeFn:function(){return A(!1)}}})}}),[R,D]),$||n.viewerEdge.isUser)return null;var B=D?"OBVIOUS":"STRONG",F=function(e,n){return function(t){return{stroke:n?t.baseColor.background.normal:e,height:"36px",width:"36px"}}},z=o.createElement(b.z,{loading:M,size:"COMPACT",buttonStyle:B,onClick:function(){var e;s?D?A(!1):s&&s.allowEmailAddressSharingEditorWriter?A(!0,!1):O():null!==(e=n.newsletterV3)&&void 0!==e&&e.id?j.event("newsletterV3.subscribeClicked",{newsletterV3Id:n.newsletterV3.id,source:x}):j.event("user.LOSubscribeClicked",{targetUserId:n.id,source:x})},padding:"0"},D?o.createElement(P,{className:t(F(r.accentColor.fill.normal,M))}):o.createElement(_.Z,{className:t(F(r.accentColor.background,M))}));return o.createElement(w.$,{isVisible:!M&&!D,hideOnClick:!0,noPortal:!0,mouseEnterDelay:500,mouseLeaveDelay:0,placement:"bottom",popoverRenderFn:function(){return o.createElement(v.x,{padding:"10px 12px",maxWidth:"166px"},o.createElement(m.F,{tag:"div",scale:"S",color:"DARKER"},"Subscribe to get an email whenever ",n.name," publishes."))},role:"tooltip",targetDistance:10},o.createElement(v.x,null,s&&o.createElement(f.Q,{onConfirm:function(){A(!0,!0)},isVisible:N,hide:C,titleText:"Confirm your subscription to ".concat(n.name),confirmText:"Confirm now",buttonStyle:"STRONG",buttonSize:"LARGE",showCancelButton:!1,withCloseButton:!1,isDestructiveAction:!1},"When you subscribe to a writer or publication, your email address will be shared with them so they can stay in contact with you outside of Medium. Opt out any time by unsubscribing in Settings."),s?z:o.createElement(d.R9,{operation:"register",newsletterV3:I,user:n,actionUrl:I?(0,T.Zul)(I.id):(0,T.lcz)(n.id),susiEntry:"subscribe_user"},z)))},x=(0,l.Ps)(L(),a.DI,a.nj)}}]);
//# sourceMappingURL=https://stats.medium.build/lite/sourcemaps/7648.a4d0495f.chunk.js.map